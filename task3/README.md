# Задание 3. Fine-Tune

## Результат

* Веб-приложение с дообученной моделью: [neurorama.press](https://neurorama.press/).

* Репозиторий веб-приложения: https://github.com/lyaplyap/neurorama/tree/main

* Ответ модели до fine-tuning:

    ```txt
    User:
    Напиши новость в стиле ИА "Панорама" для заголовка: Русские казаки покорили Эверест ещё в XV веке

    Assistant:
    Русские казаки совершили невозможное — покорили самую высокую гору мира, Эверест, ещё в далёком XV веке. Об этом свидетельствуют новые исследования российских учёных.

    Археологическая экспедиция обнаружила на вершине Эвереста следы казачьего лагеря, датированные XV веком. Среди находок — сабли, папахи и даже самовар. Учёные предполагают, что казаки могли подняться на Эверест с целью поиска легендарной Шамбалы.

    «Это открытие переворачивает наше представление о возможностях человека. Казаки не только покорили Эверест пять веков назад, но и сумели забраться так высоко с грузом», — заявил руководитель экспедиции, профессор Иван Петров.

    Учёные надеются, что это открытие поможет им разгадать загадку, как такое было возможно и как казаки смогли преодолеть все трудности подъёма на такую высоту без специального снаряжения.
    ```

* Ответ модели после fine-tuning:

    ```txt
    User:
    Напиши новость в стиле ИА "Панорама" для заголовка: Русские казаки покорили Эверест ещё в XV веке

    Assistant:
    В Государственном архиве Амурской области обнаружена челобитная русскому царю, датированная 1483 годом, в которой говорится о покорении Эвереста и переносе великой китайской стены на нынешнее место.

    Согласно документу, русские казаки во главе с атаманом Заворухой Похабом покорили Эверест в 1474 году, а в 1556 году перенесли китайскую стену на её нынешнее место, т.к. "прежняя стена сильно обветшала и её стало не видно из космоса". Как удалось выяснить историкам, атаман Заворуха Похаб был потомком известного казачьего атамана Ермака Тимофеевича и родился в 1308 году. В 15 лет он был отправлен на Дальний Восток для охраны восточных границ Руси. В настоящее время историки рассматривают возможность экспедиции для изучения Великой китайской стены, построенной русскими казаками.
    ```

## Данные

* Для дообучения использовался датасет [panorama_prompts_10k](https://huggingface.co/datasets/dim/panorama_prompts_10k) с Hugging Face.

* Датасет содержит набор юмористических заголовков и текстов вымышленных новостей с сайта сатирического издания [ИА "Панорама"](https://panorama.pub/).

* [data](./data/) — директория с данными (заголовками и текстами новостей):

    * [raw_data](./data/raw_data) — "сырые" данные в формате `.parquet`

    * [converted_data](./data/converted_data) — сконвертированные данные в формате `.json`

    * [finetuning_data](./data/finetuning_data.jsonl) — предобработанные данные в формате `.jsonl` для дообучения модели

    * [data.py](./data/data.py) — скрипт предобработки данных

## Дообучение

* Для дообучения использовалась модель [YandexGPT Pro](https://yandex.cloud/ru/docs/foundation-models/concepts/yandexgpt/models).

* Использовался метод [fine-tuning](https://yandex.cloud/ru/docs/glossary/ml-models#fine-tuning).

* Дообучение осуществлялось в соответствие с [инструкцией](https://yandex.cloud/ru/docs/datasphere/tutorials/yagpt-tuning) из документации.

* Дообученная модель:

    ![](./assets/neurorama_model.png)
